{
  "id": "610b416b-135d-4370-90be-867c28828687",
  "prevId": "00000000-0000-0000-0000-000000000000",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.integrations": {
      "name": "integrations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "uuid_generate_v4()"
        },
        "org_id": {
          "name": "org_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "platform_type": {
          "name": "platform_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "platform_store_url": {
          "name": "platform_store_url",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "access_token": {
          "name": "access_token",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "webhook_secret": {
          "name": "webhook_secret",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "last_synced_at": {
          "name": "last_synced_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_integrations_org_id": {
          "name": "idx_integrations_org_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_integrations_platform": {
          "name": "idx_integrations_platform",
          "columns": [
            {
              "expression": "platform_type",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "bool_ops"
            },
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "bool_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "integrations_org_id_fkey": {
          "name": "integrations_org_id_fkey",
          "tableFrom": "integrations",
          "tableTo": "organizations",
          "columnsFrom": [
            "org_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "integrations_platform_type_platform_store_url_key": {
          "name": "integrations_platform_type_platform_store_url_key",
          "nullsNotDistinct": false,
          "columns": [
            "platform_type",
            "platform_store_url"
          ]
        }
      },
      "policies": {
        "Multi-tenant integrations": {
          "name": "Multi-tenant integrations",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "using": "(org_id = get_user_org_id())",
          "withCheck": "(org_id = get_user_org_id())"
        }
      },
      "checkConstraints": {
        "integrations_platform_type_check": {
          "name": "integrations_platform_type_check",
          "value": "platform_type = ANY (ARRAY['shopify'::text, 'salla'::text, 'zid'::text, 'woocommerce'::text])"
        }
      },
      "isRLSEnabled": false
    },
    "public.memberships": {
      "name": "memberships",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "uuid_generate_v4()"
        },
        "org_id": {
          "name": "org_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "role": {
          "name": "role",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'owner'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_memberships_org_id": {
          "name": "idx_memberships_org_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_memberships_user_id": {
          "name": "idx_memberships_user_id",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "memberships_org_id_fkey": {
          "name": "memberships_org_id_fkey",
          "tableFrom": "memberships",
          "tableTo": "organizations",
          "columnsFrom": [
            "org_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "memberships_user_id_fkey": {
          "name": "memberships_user_id_fkey",
          "tableFrom": "memberships",
          "tableTo": "users",
          "schemaTo": "auth",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "memberships_org_id_user_id_key": {
          "name": "memberships_org_id_user_id_key",
          "nullsNotDistinct": false,
          "columns": [
            "org_id",
            "user_id"
          ]
        }
      },
      "policies": {
        "Owners manage memberships": {
          "name": "Owners manage memberships",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "using": "(org_id IN ( SELECT memberships_1.org_id\n   FROM memberships memberships_1\n  WHERE ((memberships_1.user_id = auth.uid()) AND (memberships_1.role = 'owner'::text))))",
          "withCheck": "(org_id IN ( SELECT memberships_1.org_id\n   FROM memberships memberships_1\n  WHERE ((memberships_1.user_id = auth.uid()) AND (memberships_1.role = 'owner'::text))))"
        },
        "Users see own memberships": {
          "name": "Users see own memberships",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        }
      },
      "checkConstraints": {
        "memberships_role_check": {
          "name": "memberships_role_check",
          "value": "role = ANY (ARRAY['owner'::text, 'admin'::text, 'viewer'::text])"
        }
      },
      "isRLSEnabled": false
    },
    "public.orders": {
      "name": "orders",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "uuid_generate_v4()"
        },
        "org_id": {
          "name": "org_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "integration_id": {
          "name": "integration_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "external_order_id": {
          "name": "external_order_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "order_number": {
          "name": "order_number",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "customer_phone": {
          "name": "customer_phone",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "customer_name": {
          "name": "customer_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "customer_email": {
          "name": "customer_email",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "total_price": {
          "name": "total_price",
          "type": "numeric(12, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "currency": {
          "name": "currency",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'SAR'"
        },
        "payment_method": {
          "name": "payment_method",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "raw_payload": {
          "name": "raw_payload",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_orders_created_at": {
          "name": "idx_orders_created_at",
          "columns": [
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_orders_external_id": {
          "name": "idx_orders_external_id",
          "columns": [
            {
              "expression": "external_order_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_orders_org_id": {
          "name": "idx_orders_org_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_orders_phone": {
          "name": "idx_orders_phone",
          "columns": [
            {
              "expression": "customer_phone",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "orders_integration_id_fkey": {
          "name": "orders_integration_id_fkey",
          "tableFrom": "orders",
          "tableTo": "integrations",
          "columnsFrom": [
            "integration_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "orders_org_id_fkey": {
          "name": "orders_org_id_fkey",
          "tableFrom": "orders",
          "tableTo": "organizations",
          "columnsFrom": [
            "org_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "unique_external_order_per_integration": {
          "name": "unique_external_order_per_integration",
          "nullsNotDistinct": false,
          "columns": [
            "integration_id",
            "external_order_id"
          ]
        }
      },
      "policies": {
        "Service role inserts orders": {
          "name": "Service role inserts orders",
          "as": "PERMISSIVE",
          "for": "INSERT",
          "to": [
            "service_role"
          ],
          "withCheck": "true"
        },
        "Multi-tenant orders": {
          "name": "Multi-tenant orders",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ]
        }
      },
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.organizations": {
      "name": "organizations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "uuid_generate_v4()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "slug": {
          "name": "slug",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "plan_type": {
          "name": "plan_type",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'free'"
        },
        "wa_phone_number_id": {
          "name": "wa_phone_number_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "wa_business_account_id": {
          "name": "wa_business_account_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "wa_access_token": {
          "name": "wa_access_token",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "organizations_slug_key": {
          "name": "organizations_slug_key",
          "nullsNotDistinct": false,
          "columns": [
            "slug"
          ]
        }
      },
      "policies": {
        "Owners update organizations": {
          "name": "Owners update organizations",
          "as": "PERMISSIVE",
          "for": "UPDATE",
          "to": [
            "authenticated"
          ],
          "using": "(id IN ( SELECT memberships.org_id\n   FROM memberships\n  WHERE ((memberships.user_id = auth.uid()) AND (memberships.role = 'owner'::text))))",
          "withCheck": "(id IN ( SELECT memberships.org_id\n   FROM memberships\n  WHERE ((memberships.user_id = auth.uid()) AND (memberships.role = 'owner'::text))))"
        },
        "Users see their organizations": {
          "name": "Users see their organizations",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        }
      },
      "checkConstraints": {
        "organizations_plan_type_check": {
          "name": "organizations_plan_type_check",
          "value": "plan_type = ANY (ARRAY['free'::text, 'pro'::text, 'enterprise'::text])"
        }
      },
      "isRLSEnabled": false
    },
    "auth.users": {
      "name": "users",
      "schema": "auth",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.verifications": {
      "name": "verifications",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "uuid_generate_v4()"
        },
        "org_id": {
          "name": "org_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "order_id": {
          "name": "order_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "verification_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "wa_message_id": {
          "name": "wa_message_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "template_name": {
          "name": "template_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'cod_verification'"
        },
        "language_code": {
          "name": "language_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'ar'"
        },
        "attempts": {
          "name": "attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "last_sent_at": {
          "name": "last_sent_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "next_retry_at": {
          "name": "next_retry_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "confirmed_at": {
          "name": "confirmed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "canceled_at": {
          "name": "canceled_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "expired_at": {
          "name": "expired_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_verifications_next_retry": {
          "name": "idx_verifications_next_retry",
          "columns": [
            {
              "expression": "next_retry_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "timestamptz_ops"
            }
          ],
          "isUnique": false,
          "where": "(status = ANY (ARRAY['pending'::verification_status, 'sent'::verification_status]))",
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_verifications_org_id": {
          "name": "idx_verifications_org_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_verifications_status": {
          "name": "idx_verifications_status",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "enum_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_verifications_wa_id": {
          "name": "idx_verifications_wa_id",
          "columns": [
            {
              "expression": "wa_message_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "verifications_order_id_fkey": {
          "name": "verifications_order_id_fkey",
          "tableFrom": "verifications",
          "tableTo": "orders",
          "columnsFrom": [
            "order_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "verifications_org_id_fkey": {
          "name": "verifications_org_id_fkey",
          "tableFrom": "verifications",
          "tableTo": "organizations",
          "columnsFrom": [
            "org_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "unique_active_verification_per_order": {
          "name": "unique_active_verification_per_order",
          "nullsNotDistinct": false,
          "columns": [
            "order_id"
          ]
        }
      },
      "policies": {
        "Service role updates verifications": {
          "name": "Service role updates verifications",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ],
          "using": "true",
          "withCheck": "true"
        },
        "Multi-tenant verifications": {
          "name": "Multi-tenant verifications",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ]
        }
      },
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {
    "public.verification_status": {
      "name": "verification_status",
      "schema": "public",
      "values": [
        "pending",
        "sent",
        "delivered",
        "confirmed",
        "canceled",
        "expired",
        "failed"
      ]
    }
  },
  "schemas": {
    "auth": "auth"
  },
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}